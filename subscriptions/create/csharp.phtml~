<?php

?>
<p>
The C# code snippet below shows how to subscribe a phone number to a subscription service using our API. 
</p>

<p>
The code uses our C# gateway class: <strong>AfricasTalkingGateway.cs</strong> <span class="download_link">[<a href='/smslibraries/csharp'><i class="ti-download" ></i>  Download</a>]</span>
</p>

<p>
To help decode JSON responses, you will need to add a reference to <strong>System.Web.Extensions</strong> and <strong>System.Microsoft.CSharp</strong>
</p>

<fieldset style="width:98%;" class='boxed code'>
<pre class="csharpCode">
using System;

class MainClass
{
	static public void Main (){
		
		// Specify your login credentials
		string username = "MyAfricasTalkingUsername";
		string apiKey   = "MyAfricasTalkingAPIKey";
		
		// Specify the number that you want to subscribe
		// Please ensure you include the country code (+254 for Kenya in this case)
		string phoneNumber   = "+254711YYYZZZ";
		
		//Specify your Africa's Talking premium short code and keyword
		string shortCode = "myAfricasTalkingShortCode";
		string keyword   = "myAfricasTalkingKeyword"; 
		
		//Create an instance of our gateway class and pass your login credentials
		AfricasTalkingGateway gateway = new AfricasTalkingGateway(username, apiKey);
		
		// Any gateway error will be captured by our custom Exception class as shown below, 
		// so wrap the call in a try-catch block          
		try {
			
			dynamic result = gateway.createSubscription(phoneNumber, shortCode, keyword);
			Console.WriteLine("Status: " + result["status"]);
			Console.WriteLine("Description: " + result["description"]);
			
		} catch (AfricasTalkingGatewayException e) {

			Console.WriteLine ("Encountered an error: " + e.Message);		

		}
	}
}

</pre>	
</fieldset>